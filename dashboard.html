<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de ROI - GestÃ£o de TrÃ¡fego</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Inter:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #FF6D00;
            --primary-dark: #E65100;
            --success: #00E676;
            --danger: #FF1744;
            --dark: #121212;
            --dark-surface: #1E1E1E;
            --dark-border: #333;
            --text-main: #E0E0E0;
            --text-muted: #999;
            --white: #ffffff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--dark);
            color: var(--text-main);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* HEADER */
        header {
            background: linear-gradient(135deg, var(--dark-surface) 0%, #111 100%);
            padding: 20px 40px;
            border-bottom: 1px solid var(--dark-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo span {
            color: var(--white);
        }

        /* TABS */
        .tabs-container {
            display: flex;
            gap: 10px;
            padding: 20px 40px;
            background: #181818;
        }

        .tab-btn {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            color: var(--text-muted);
            padding: 10px 25px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
            box-shadow: 0 4px 15px rgba(255, 109, 0, 0.3);
        }

        .add-tab {
            background: transparent;
            border: 2px dashed var(--dark-border);
            color: var(--text-muted);
            padding: 10px 15px;
            border-radius: 12px;
            cursor: pointer;
        }

        /* MAIN CONTENT */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            padding: 20px 40px;
        }

        /* SUMMARY CARDS */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: var(--dark-surface);
            padding: 25px;
            border-radius: 20px;
            border: 1px solid var(--dark-border);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-label {
            font-size: 0.85rem;
            color: var(--text-muted);
            text-transform: uppercase;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .card-value {
            font-size: 1.8rem;
            font-weight: 800;
        }

        .card-value.profit {
            color: var(--success);
        }

        .card-value.expense {
            color: var(--danger);
        }

        /* TABLE AREA */
        .table-container {
            background: var(--dark-surface);
            border-radius: 20px;
            border: 1px solid var(--dark-border);
            overflow: hidden;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-family: 'Inter', sans-serif;
        }

        thead th {
            background: var(--primary);
            color: var(--white);
            text-align: left;
            padding: 15px;
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.85rem;
        }

        tbody td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--dark-border);
            font-size: 0.95rem;
        }

        tbody tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }

        input {
            background: transparent;
            border: 1px solid transparent;
            color: var(--text-main);
            width: 100%;
            padding: 5px;
            border-radius: 4px;
            font-family: inherit;
            font-size: inherit;
        }

        input:focus {
            border-color: var(--primary);
            outline: none;
            background: rgba(255, 109, 0, 0.05);
        }

        /* FOOTER ROW */
        .table-footer {
            background: #111;
            font-weight: 800;
        }

        .table-footer td {
            padding: 20px 15px;
            border-top: 2px solid var(--dark-border);
        }

        /* SIDEBAR (FIXED EXPENSES) */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .fixed-expenses-box {
            background: var(--dark-surface);
            border-radius: 20px;
            border: 1px solid var(--dark-border);
            padding: 25px;
        }

        .fixed-title {
            background: var(--danger);
            color: var(--white);
            padding: 10px 15px;
            border-radius: 10px;
            font-weight: 800;
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .fixed-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--dark-border);
        }

        .fixed-item span:first-child {
            color: var(--text-muted);
        }

        .fixed-item span:last-child {
            font-weight: 700;
        }

        .total-fixed {
            background: var(--danger);
            color: var(--white);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-top: 10px;
            font-weight: 800;
        }

        /* GOAL BOX */
        .goal-box {
            background: #111;
            padding: 25px;
            border-radius: 20px;
            border: 1px solid var(--dark-border);
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 12px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            width: 0%;
            transition: width 0.5s ease;
        }

        /* BUTTONS */
        .btn-save {
            background: var(--success);
            color: var(--dark);
            border: none;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 800;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: 0.3s;
        }

        .btn-save:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 230, 118, 0.3);
        }

        /* MOBILE RESPONSIVE */
        @media (max-width: 1100px) {
            .main-layout {
                grid-template-columns: 1fr;
            }

            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>

<body>

    <header>
        <div class="logo">ðŸš€ ROI<span>MASTER</span></div>
        <div style="display: flex; gap: 15px;">
            <button class="btn-save" onclick="saveData()" style="margin-top: 0; padding: 10px 20px;">SALVAR
                DADOS</button>
        </div>
    </header>

    <div class="tabs-container" id="tabsList">
        <!-- Tabs will be generated here -->
    </div>

    <div class="main-layout">
        <div class="content-area">
            <!-- SUMMARY -->
            <div class="summary-grid">
                <div class="card">
                    <div class="card-label">Gasto Total</div>
                    <div class="card-value expense" id="sumExpenses">R$ 0,00</div>
                </div>
                <div class="card">
                    <div class="card-label">Receita Total</div>
                    <div class="card-value" id="sumRevenue">R$ 0,00</div>
                </div>
                <div class="card">
                    <div class="card-label">Lucro LÃ­quido</div>
                    <div class="card-value profit" id="sumProfit">R$ 0,00</div>
                </div>
                <div class="card">
                    <div class="card-label">ROI MÃ©dio</div>
                    <div class="card-value" id="avgROI">0.00x</div>
                </div>
            </div>

            <!-- SPREADSHEET -->
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th style="width: 80px;">Dia</th>
                            <th style="width: 120px;">Data</th>
                            <th>Gastos (R$)</th>
                            <th>Receita (R$)</th>
                            <th>Lucro (R$)</th>
                            <th>ROI</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Rows will be generated here -->
                    </tbody>
                    <tfoot>
                        <tr class="table-footer">
                            <td colspan="2">TOTAL</td>
                            <td id="footExpenses">R$ 0,00</td>
                            <td id="footRevenue">R$ 0,00</td>
                            <td id="footProfit" style="color: var(--success);">R$ 0,00</td>
                            <td id="footROI">0.00</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <button class="tab-btn" onclick="addRow()"
                style="margin-top: 15px; background: transparent; border-style: dashed;">+ Adicionar Dia</button>
        </div>

        <!-- SIDEBAR -->
        <div class="sidebar">
            <div class="fixed-expenses-box">
                <div class="fixed-title">Despesas Fixas</div>
                <div id="fixedExpensesList">
                    <!-- Fixed items here -->
                </div>
                <div class="total-fixed" id="totalFixed">TOTAL: R$ 0,00</div>
                <button class="tab-btn" onclick="addFixedExpense()"
                    style="width: 100%; margin-top: 10px; font-size: 0.8rem;">+ Adicionar Gasto Fixo</button>
            </div>

            <div class="goal-box">
                <div class="goal-header">
                    <span style="font-weight: 800;">META DE LUCRO</span>
                    <span id="goalValueText" style="color: var(--primary);">R$ 5.000</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="goalProgress"></div>
                </div>
                <div style="display: flex; justify-content: space-between; font-size: 0.85rem;">
                    <span id="distText">Faltam R$ 5.000</span>
                    <span id="percentText">0%</span>
                </div>
                <input type="number" id="goalInput" placeholder="Mudar Meta" onchange="updateGoal(this.value)"
                    style="margin-top: 15px; background: #222; border: 1px solid #333; padding: 8px;">
            </div>
        </div>
    </div>

    <script>
        // DATA STRUCTURE
        let state = {
            activeTab: 0,
            offers: [
                {
                    name: "Oferta 4",
                    goal: 5000,
                    rows: [
                        { day: "Dia 1", date: "22/12", spend: 0, earn: 0 }
                    ],
                    fixed: [
                        { label: "ChatGPT", value: 99 },
                        { label: "Proxy", value: 30 }
                    ]
                },
                {
                    name: "Oferta 10",
                    goal: 10000,
                    rows: [
                        { day: "Dia 1", date: "22/12", spend: 0, earn: 0 }
                    ],
                    fixed: []
                }
            ]
        };

        // LOAD FROM LOCALSTORAGE
        const saved = localStorage.getItem('roi_master_data');
        if (saved) state = JSON.parse(saved);

        function init() {
            renderTabs();
            renderContent();
        }

        function renderTabs() {
            const container = document.getElementById('tabsList');
            container.innerHTML = state.offers.map((off, idx) => `
                <button class="tab-btn ${state.activeTab === idx ? 'active' : ''}" onclick="switchTab(${idx})">
                    ${off.name}
                </button>
            `).join('') + `<button class="add-tab" onclick="addOffer()">+</button>`;
        }

        function switchTab(idx) {
            state.activeTab = idx;
            renderTabs();
            renderContent();
        }

        function addOffer() {
            const name = prompt("Nome da Oferta:");
            if (name) {
                state.offers.push({
                    name: name,
                    goal: 5000,
                    rows: [{ day: "Dia 1", date: "", spend: 0, earn: 0 }],
                    fixed: []
                });
                state.activeTab = state.offers.length - 1;
                init();
            }
        }

        function renderContent() {
            const offer = state.offers[state.activeTab];
            const tbody = document.getElementById('tableBody');

            // Render Rows
            tbody.innerHTML = offer.rows.map((row, idx) => `
                <tr>
                    <td><input value="${row.day}" onchange="updateRow(${idx}, 'day', this.value)"></td>
                    <td><input value="${row.date}" onchange="updateRow(${idx}, 'date', this.value)"></td>
                    <td><input type="number" value="${row.spend}" onchange="updateRow(${idx}, 'spend', this.value)"></td>
                    <td><input type="number" value="${row.earn}" onchange="updateRow(${idx}, 'earn', this.value)"></td>
                    <td style="font-weight: 700; color: ${row.earn - row.spend >= 0 ? 'var(--success)' : 'var(--danger)'}">
                        R$ ${(row.earn - row.spend).toLocaleString('pt-BR')}
                    </td>
                    <td style="font-weight: 700;">
                        ${row.spend > 0 ? (row.earn / row.spend).toFixed(2) : '0.00'}
                    </td>
                </tr>
            `).join('');

            // Render Fixed
            const fixedList = document.getElementById('fixedExpensesList');
            fixedList.innerHTML = offer.fixed.map((f, idx) => `
                <div class="fixed-item">
                    <input value="${f.label}" onchange="updateFixed(${idx}, 'label', this.value)" style="width: 60%; font-size: 0.8rem;">
                    <input type="number" value="${f.value}" onchange="updateFixed(${idx}, 'value', this.value)" style="width: 30%; font-size: 0.8rem; text-align: right;">
                </div>
            `).join('');

            calculateTotals();
        }

        function updateRow(idx, field, val) {
            const offer = state.offers[state.activeTab];
            if (field === 'spend' || field === 'earn') val = parseFloat(val) || 0;
            offer.rows[idx][field] = val;
            renderContent();
        }

        function addRow() {
            const offer = state.offers[state.activeTab];
            offer.rows.push({ day: `Dia ${offer.rows.length + 1}`, date: "", spend: 0, earn: 0 });
            renderContent();
        }

        function updateFixed(idx, field, val) {
            const offer = state.offers[state.activeTab];
            if (field === 'value') val = parseFloat(val) || 0;
            offer.fixed[idx][field] = val;
            renderContent();
        }

        function addFixedExpense() {
            state.offers[state.activeTab].fixed.push({ label: "Novo Gasto", value: 0 });
            renderContent();
        }

        function updateGoal(val) {
            state.offers[state.activeTab].goal = parseFloat(val) || 0;
            renderContent();
        }

        function calculateTotals() {
            const offer = state.offers[state.activeTab];
            let totalSpend = offer.rows.reduce((acc, r) => acc + r.spend, 0);
            let totalEarn = offer.rows.reduce((acc, r) => acc + r.earn, 0);
            let totalFixed = offer.fixed.reduce((acc, f) => acc + f.value, 0);

            let netProfit = totalEarn - totalSpend - totalFixed;
            let roi = totalSpend > 0 ? (totalEarn / totalSpend) : 0;

            // Update Cards
            document.getElementById('sumExpenses').innerText = `R$ ${(totalSpend + totalFixed).toLocaleString('pt-BR')}`;
            document.getElementById('sumRevenue').innerText = `R$ ${totalEarn.toLocaleString('pt-BR')}`;
            document.getElementById('sumProfit').innerText = `R$ ${netProfit.toLocaleString('pt-BR')}`;
            document.getElementById('avgROI').innerText = `${roi.toFixed(2)}x`;

            // Update Table Footer
            document.getElementById('footExpenses').innerText = `R$ ${totalSpend.toLocaleString('pt-BR')}`;
            document.getElementById('footRevenue').innerText = `R$ ${totalEarn.toLocaleString('pt-BR')}`;
            document.getElementById('footProfit').innerText = `R$ ${(totalEarn - totalSpend).toLocaleString('pt-BR')}`;
            document.getElementById('footROI').innerText = roi.toFixed(2);

            // Update Fixed Total
            document.getElementById('totalFixed').innerText = `TOTAL: R$ ${totalFixed.toLocaleString('pt-BR')}`;

            // Update Goal
            const goal = offer.goal;
            document.getElementById('goalValueText').innerText = `R$ ${goal.toLocaleString('pt-BR')}`;
            let percent = goal > 0 ? Math.min((netProfit / goal) * 100, 100) : 0;
            if (netProfit < 0) percent = 0;

            document.getElementById('goalProgress').style.width = `${percent}%`;
            document.getElementById('percentText').innerText = `${percent.toFixed(1)}%`;

            let dist = goal - netProfit;
            document.getElementById('distText').innerText = dist > 0 ? `Faltam R$ ${dist.toLocaleString('pt-BR')}` : "Meta Batida! ðŸ”¥";
        }

        function saveData() {
            localStorage.setItem('roi_master_data', JSON.stringify(state));
            alert("Dados salvos com sucesso no seu navegador!");
        }

        init();
    </script>
</body>

</html>